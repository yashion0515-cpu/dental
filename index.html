<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­¯ç§‘åŒ»é™¢æƒ…å ±ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ </title>
    <style>
    .success-message {
        display: none;
        text-align: center;
        margin-top: 40px;
    }

    .success-card {
        border: 1px solid #d4af37;
        padding: 30px;
        border-radius: 12px;
        background: #fffdf8;
    }

    .success-title {
        font-size: 22px;
        font-weight: bold;
        color: #333;
        margin-bottom: 15px;
    }

    .success-text {
        font-size: 15px;
        color: #555;
        margin-bottom: 25px;
    }

    .affiliate-button {
        display: inline-block;
        background: linear-gradient(135deg, #d4af37, #f5e08a);
        color: #000;
        font-weight: bold;
        padding: 15px 30px;
        border-radius: 30px;
        text-decoration: none;
        font-size: 16px;
    }
    </style>
    <script src="https://static.line-scdn.net/liff/sdk/2.16.1/liff.js"></script>
    <style>
        /* (ã‚¹ã‚¿ã‚¤ãƒ«ã¯çœç•¥) */
        body { font-family: sans-serif; padding: 20px; }
        input { width: 100%; padding: 10px; margin-bottom: 15px; box-sizing: border-box; }
        button { background-color: #00B900; color: white; padding: 15px 20px; border: none; cursor: pointer; }
        .success-message { color: green; font-weight: bold; margin-top: 20px; display: none; }
    </style>
</head>
<body>
    <h1>é‡‘ä¹³æ­¯ å–æ‰±æ­¯ç§‘åŒ»é™¢ ç™»éŒ²</h1>
    <form id="registrationForm">
       <label for="hospitalName">æ­¯ç§‘åŒ»é™¢å:</label>
       <input type="text" id="hospitalName" required>

       <label for="representativeName">ä»£è¡¨è€…å:</label>
       <input type="text" id="representativeName" required>

       <label for="postalCode">éƒµä¾¿ç•ªå·:</label>
       <input type="text" id="postalCode" placeholder="ä¾‹ï¼š123-4567" required>

       <label for="address">ä½æ‰€:</label>
       <input type="text" id="address" required>

       <label for="phoneNumber">é›»è©±ç•ªå·:</label>
       <input type="tel" id="phoneNumber" required>

       <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</label>
       <input type="email" id="email" required>

       <button type="submit" id="submitButton">æƒ…å ±ã‚’ç™»éŒ²ã™ã‚‹</button>
   </form>
    
ã€€ã€€<div id="successMessage" class="success-message">
    <div class="success-card">
        <div class="success-title">ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸ ğŸ‰</div>

        <div class="success-text">
            ã”ç™»éŒ²ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<br>
            ç¶šã„ã¦ã€å ±é…¬ã‚’å—ã‘å–ã‚‹ãŸã‚ã«<br>
            <strong>ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆç™»éŒ²</strong>ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚
        </div>

        <a
            class="affiliate-button"
            href="https://affitch.com/signup?ref=yashio-gold"
            target="_blank"
        >
            ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆç™»éŒ²ã¸é€²ã‚€ â†’
        </a>
    </div>
</div>

    <script>
// éƒµä¾¿ç•ªå· â†’ ä½æ‰€è‡ªå‹•å…¥åŠ›
document.getElementById('postalCode').addEventListener('blur', async function () {
    const postalCode = this.value.replace('-', '').trim();

    // 7æ¡ãƒã‚§ãƒƒã‚¯
    if (!/^\d{7}$/.test(postalCode)) {
        return;
    }

    try {
        const response = await fetch(
            `https://zipcloud.ibsnet.co.jp/api/search?zipcode=${postalCode}`
        );

        const result = await response.json();

        if (result.status === 200 && result.results) {
            const addressData = result.results[0];

            const fullAddress =
                addressData.address1 +
                addressData.address2 +
                addressData.address3;

            document.getElementById('address').value = fullAddress;
        }

    } catch (error) {
        console.error('éƒµä¾¿ç•ªå·æ¤œç´¢ã‚¨ãƒ©ãƒ¼', error);
        // é€šä¿¡å¤±æ•—æ™‚ã¯ä½•ã‚‚ã—ãªã„ï¼ˆæ‰‹å…¥åŠ›OKï¼‰
    }
});

        // ã€é‡è¦ã€‘ã“ã“ã«GASã§å–å¾—ã—ãŸã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URLã‚’è¨˜å…¥ã—ã¾ã™
        const GAS_ENDPOINT = 'https://script.google.com/macros/s/AKfycbzPB4Sw8yG_gwqkkdgngPEK7T6iQhUMzOBFg1-SX7vGCZ4irOzYEXbpNRW1bt3j5g1r/exec';
        // ã€é‡è¦ã€‘LIFF IDã‚’ã“ã“ã«è¨­å®šã—ã¾ã™
        const LIFF_ID = '2008433362-NxOdJgkP'; 

     async function initializeLiff() {
      try {
        await liff.init({ liffId: LIFF_ID });

        if (!liff.isInClient()) {
          alert('LINEã‚¢ãƒ—ãƒªå†…ã‹ã‚‰é–‹ã„ã¦ãã ã•ã„');
          return;
        }

        console.log('LIFF OK');

      } catch (err) {
        console.error(err);
        alert('LIFFã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚LINEã‚¢ãƒ—ãƒªã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
      }
    }

    // â˜… ã“ã‚ŒãŒç„¡ã„ã¨çµ¶å¯¾ã«å‹•ã‹ãªã„
     initializeLiff();
  </script>
    </script>
</body>
</html>


